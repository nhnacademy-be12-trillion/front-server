<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/base}">

<head>
    <meta charset="utf-8">
    <title>Trillion-Shop | My Page - 취소/반품 내역</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Book Store, MyPage, Member" name="keywords">
    <meta content="Online Book Store My Page" name="description">

    <link th:href="@{/img/favicon.ico}" rel="icon">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link th:href="@{/lib/animate/animate.min.css}" rel="stylesheet">
    <link th:href="@{/lib/owlcarousel/assets/owl.carousel.min.css}" rel="stylesheet">
    <link href="/static/css/style.min.css" rel="stylesheet">
</head>

<body>
<div class="container-fluid">
  <div class="row px-xl-5">

    <!-- 왼쪽 MY 메뉴 (공통) -->
    <div class="col-lg-3 col-md-4">
      <h5 class="section-title position-relative text-uppercase mb-3">
        <span class="bg-secondary pr-3">MY 메뉴</span>
      </h5>

      <div class="nav flex-column nav-pills mypage-menu" aria-orientation="vertical">
        <!-- 회원 정보 관리 -->
        <h6 class="text-dark mb-2">👤 회원 정보 관리</h6>
        <a class="list-group-item list-group-item-action"
           th:classappend="${activeTab == 'profile'} ? ' active'"
           th:href="@{/my-page/profile}">
          개인정보 수정
        </a>
        <a class="list-group-item list-group-item-action"
           th:classappend="${activeTab == 'reviews'} ? ' active'"
           th:href="@{/my-page/reviews}">
          마이 리뷰
        </a>
        <a class="list-group-item list-group-item-action"
           th:classappend="${activeTab == 'addresses'} ? ' active'"
           th:href="@{/my-page/addresses}">
          배송 주소록 관리
        </a>
        <hr class="my-3">

        <!-- 주문 내역 -->
        <h6 class="text-dark mb-2 mt-4">📦 주문 내역</h6>
        <a class="list-group-item list-group-item-action"
           th:classappend="${activeTab == 'orders'} ? ' active'"
           th:href="@{/my-page/orders}">
          주문/배송 조회
        </a>
        <a class="list-group-item list-group-item-action"
           th:classappend="${activeTab == 'history'} ? ' active'"
           th:href="@{/my-page/history}">
          취소/반품 내역
        </a>

        <hr class="my-3">

        <!-- 회원 탈퇴 -->
        <a th:href="@{/my-page/withdraw}" class="list-group-item list-group-item-action text-danger">
          회원 탈퇴
        </a>
      </div>
    </div>

    <!-- 위 공통 메뉴 붙이고 activeTab == 'history' 세팅 -->

    <!-- 오른쪽: 취소/반품 내역 -->
    <div class="col-lg-9 col-md-8">
      <h5 class="section-title position-relative text-uppercase mb-3">
        <span class="bg-secondary pr-3">취소/반품 내역</span>
      </h5>

      <!-- 상단 서브 탭 (주문 취소 / 상품 반품) 그대로 유지해도 되고,
           필요 없으면 그냥 두 개의 섹션으로 나눠도 됨 -->

      <ul class="nav nav-tabs" id="historySubTab" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" data-toggle="tab" href="#cancel-history" role="tab">
            주문 취소 내역
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#return-history" role="tab">
            상품 반품 내역
          </a>
        </li>
      </ul>

      <div class="tab-content" id="historySubTabContent">
        <!-- 주문 취소 내역 -->
        <div class="tab-pane fade show active" id="cancel-history" role="tabpanel">
          <div class="bg-light p-4 mt-3">
            <div class="table-responsive">
              <table class="table table-bordered mb-0 text-center">
                <thead style="background-color:#f3fcff;">
                <tr>
                  <th style="width:20%;">주문일</th>
                  <th style="width:40%;">주문번호</th>
                  <th style="width:25%;">취소 금액</th>
                  <th style="width:15%;">상태</th>
                </tr>
                </thead>
                <tbody>
                <!-- th:each="order : ${cancelledOrders}" ... 기존 코드 그대로 -->
                <tr th:if="${cancelledOrders == null or #lists.isEmpty(cancelledOrders)}">
                  <td colspan="4" class="py-5 text-muted">
                    주문을 취소한 내역이 없습니다.
                  </td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- 상품 반품 내역 -->
        <div class="tab-pane fade" id="return-history" role="tabpanel">
          <div class="bg-light p-4 mt-3">
            <div class="table-responsive">
              <table class="table table-bordered mb-0 text-center">
                <thead style="background-color:#f3fcff;">
                <tr>
                  <th style="width:15%;">반품 신청일</th>
                  <th style="width:40%;">상품 정보</th>
                  <th style="width:15%;">반품 금액</th>
                  <th style="width:15%;">수량</th>
                  <th style="width:15%;">상태</th>
                </tr>
                </thead>
                <tbody>
                <!-- th:each="item : ${returnedItems}" ... 기존 코드 그대로 -->
                <tr th:if="${returnedItems == null or #lists.isEmpty(returnedItems)}">
                  <td colspan="5" class="py-5 text-muted">
                    상품을 반품한 내역이 없습니다.
                  </td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

      </div><!-- /tab-content -->
    </div><!-- /col-lg-9 -->

  </div>
</div>
</body>
</html>
