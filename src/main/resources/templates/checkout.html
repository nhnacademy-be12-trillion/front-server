<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{base}">

<head>
    <meta charset="UTF-8">
    <title>Trillion-Shop | 주문서 작성</title>

    <!-- base.html 에서 CSS, 기본 head 요소 포함됨 -->
    <th:block layout:fragment="head">
        <!-- 이 페이지 전용 추가 CSS가 필요하면 여기에 -->
    </th:block>
</head>

<body>
<div layout:fragment="content">

    <!-- 주문서 작성 시작 -->
    <div class="container-fluid">
        <div class="row px-xl-5">

            <!-- ===== 좌측: 배송 정보 입력 ===== -->
            <div class="col-lg-8">
                <h5 class="section-title position-relative text-uppercase mb-3">
                    <span class="bg-secondary pr-3">배송 정보</span>
                </h5>

                <div class="bg-light p-30 mb-5">
                    <form th:action="@{/api/orders/complete}" method="post">

                        <!-- 수령인 정보 -->
                        <div class="row">
                            <div class="col-md-6 form-group">
                                <label>수령인 이름</label>
                                <input class="form-control" type="text" name="receiver"
                                       th:value="${orderForm.receiver}">
                            </div>
                            <div class="col-md-6 form-group">
                                <label>연락처</label>
                                <input class="form-control" type="text" name="phone"
                                       th:value="${orderForm.phone}">
                            </div>
                            <div class="col-md-12 form-group">
                                <label>이메일</label>
                                <input class="form-control" type="email" name="email"
                                       th:value="${orderForm.email}">
                            </div>
                        </div>

                        <!-- 주소 -->
                        <div class="row">
                            <div class="col-md-12 form-group">
                                <label>우편번호</label>
                                <div class="d-flex">
                                    <input class="form-control" type="text" name="zipcode"
                                           th:value="${orderForm.zipcode}">
                                    <button type="button" class="btn btn-outline-primary ml-2">주소 검색</button>
                                </div>
                            </div>
                            <div class="col-md-12 form-group">
                                <label>기본 주소</label>
                                <input class="form-control" type="text" name="address1"
                                       th:value="${orderForm.address1}">
                            </div>
                            <div class="col-md-12 form-group">
                                <label>상세 주소</label>
                                <input class="form-control" type="text" name="address2"
                                       th:value="${orderForm.address2}">
                            </div>
                        </div>

                        <!-- 배송 메모 -->
                        <div class="form-group">
                            <label>배송 메모</label>
                            <textarea class="form-control" rows="2"
                                      name="deliveryMessage"
                                      placeholder="예: 경비실에 맡겨주세요"
                                      th:text="${orderForm.deliveryMessage}"></textarea>
                        </div>

                        <!-- 결제 수단 -->
                        <h5 class="section-title position-relative text-uppercase mt-4 mb-3">
                            <span class="bg-secondary pr-3">결제 수단</span>
                        </h5>

                        <div class="bg-white p-3 border">
                            <div class="form-group mb-2">
                                <input type="radio" id="payment-card" name="payment" value="CARD" checked>
                                <label for="payment-card" class="ml-2">신용/체크카드</label>
                            </div>
                            <div class="form-group mb-2">
                                <input type="radio" id="payment-bank" name="payment" value="BANK">
                                <label for="payment-bank" class="ml-2">계좌이체</label>
                            </div>
                            <div class="form-group mb-0">
                                <input type="radio" id="payment-vbank" name="payment" value="VBANK">
                                <label for="payment-vbank" class="ml-2">가상계좌</label>
                            </div>
                        </div>

                        <!-- 숨겨진 값 (장바구니 ID 포함 등) -->
                        <input type="hidden" name="cartId" th:value="${cart.id}">
                    </form>
                </div>
            </div>

            <!-- ===== 우측: 주문 요약 ===== -->
            <div class="col-lg-4">
                <h5 class="section-title position-relative text-uppercase mb-3">
                    <span class="bg-secondary pr-3">결제 요약</span>
                </h5>

                <div class="bg-light p-30 mb-5">
                    <div class="border-bottom pb-2">

                        <!-- 상품 금액 -->
                        <div class="d-flex justify-content-between mb-3">
                            <h6>상품 금액</h6>
                            <h6 th:text="${#numbers.formatInteger(orderSummary.subTotal, 0, 'COMMA')} + '원'">
                                72,000원
                            </h6>
                        </div>

                        <!-- 배송비 -->
                        <div class="d-flex justify-content-between">
                            <h6 class="font-weight-medium">배송비</h6>
                            <h6 class="font-weight-medium"
                                th:text="${orderSummary.shippingFee > 0 ?
                                        #numbers.formatInteger(orderSummary.shippingFee, 0, 'COMMA') + '원' : '무료'}">
                                3,000원
                            </h6>
                        </div>
                    </div>

                    <!-- 총 금액 -->
                    <div class="pt-2">
                        <div class="d-flex justify-content-between mt-2">
                            <h5>총 결제 금액</h5>
                            <h5 th:text="${#numbers.formatInteger(orderSummary.totalPrice, 0, 'COMMA')} + '원'">
                                75,000원
                            </h5>
                        </div>

                        <!-- 결제 진행 버튼 -->
                        <form th:action="@{/api/orders/complete}" method="post">
                            <button type="submit"
                                    class="btn btn-block btn-primary font-weight-bold my-3 py-3">
                                결제하기
                            </button>
                        </form>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<th:block layout:fragment="script">
    <!-- checkout 페이지 전용 JS 가 필요하면 여기에 -->
    <!-- <script th:src="@{/js/checkout.js}"></script> -->
</th:block>

</body>
</html>
